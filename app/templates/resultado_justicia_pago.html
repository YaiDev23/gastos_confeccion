{% extends "base.html" %}

{% block title %}Resultado: An√°lisis de Justicia de Pago{% endblock %}

{% block content %}
<h1>üìä Resultado: An√°lisis de Justicia de Pago</h1>

<div style="margin-bottom: 20px; padding: 15px; background-color: #f0f0f0; border-radius: 5px;">
    <p style="margin: 0; color: #666; font-size: 14px;">
        <strong>Generado:</strong> {{ fecha_hora_bogota }}
    </p>
</div>

<!-- RESUMEN PRINCIPAL -->
<div style="background-color: #f8f9fa; border: 2px solid #ff9800; border-radius: 10px; padding: 25px; margin-bottom: 30px;">
    <h2 style="color: #ff9800; text-align: center; margin-top: 0;">An√°lisis General</h2>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
        <div style="background-color: white; padding: 15px; border-radius: 5px; border-left: 4px solid #2196F3;">
            <p style="margin: 0 0 5px 0; color: #666; font-size: 12px;">Tiempo por unidad</p>
            <h3 style="margin: 0; color: #2196F3; font-size: 24px;">{{ datos.tiempo_unitario }} min</h3>
        </div>
        <div style="background-color: white; padding: 15px; border-radius: 5px; border-left: 4px solid #4CAF50;">
            <p style="margin: 0 0 5px 0; color: #666; font-size: 12px;">Cantidad de unidades</p>
            <h3 style="margin: 0; color: #4CAF50; font-size: 24px;">{{ "{:,.0f}".format(datos.cantidad) }} unidades</h3>
        </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
        <div style="background-color: white; padding: 15px; border-radius: 5px; border-left: 4px solid #9c27b0;">
            <p style="margin: 0 0 5px 0; color: #666; font-size: 12px;">Tarifa por minuto</p>
            <h3 style="margin: 0; color: #9c27b0; font-size: 24px;">${{ "{:,.2f}".format(datos.tarifa_minuto) }}</h3>
        </div>
        <div style="background-color: white; padding: 15px; border-radius: 5px; border-left: 4px solid #ff5722;">
            <p style="margin: 0 0 5px 0; color: #666; font-size: 12px;">Pago total del lote</p>
            <h3 style="margin: 0; color: #ff5722; font-size: 24px;">${{ "{:,.0f}".format(datos.pago_lote) }}</h3>
        </div>
    </div>
</div>

<!-- C√ÅLCULOS DETALLADOS -->
<div style="background-color: #e3f2fd; border: 2px solid #2196F3; border-radius: 10px; padding: 25px; margin-bottom: 30px;">
    <h2 style="color: #1976d2; margin-top: 0;">1Ô∏è‚É£ C√°lculos Detallados</h2>
    
    <div style="background-color: white; padding: 20px; border-radius: 5px; margin-bottom: 15px;">
        <h3 style="color: #1976d2; margin-top: 0;">Tiempo total del lote:</h3>
        <p style="font-size: 16px; margin: 10px 0;">
            <code style="background-color: #f5f5f5; padding: 8px 12px; border-radius: 3px;">
                {{ datos.tiempo_unitario }} min √ó {{ "{:,.0f}".format(datos.cantidad) }} = <strong>{{ "{:,.0f}".format(datos.tiempo_total) }} minutos</strong>
            </code>
        </p>
        <p style="color: #666; margin: 5px 0; font-size: 14px;">
            O equivalente a <strong>{{ "%.1f" | format(datos.tiempo_total / 60) }} horas</strong>
        </p>
    </div>

    <div style="background-color: white; padding: 20px; border-radius: 5px; margin-bottom: 15px;">
        <h3 style="color: #1976d2; margin-top: 0;">Costo real del trabajo:</h3>
        <p style="font-size: 16px; margin: 10px 0;">
            <code style="background-color: #f5f5f5; padding: 8px 12px; border-radius: 3px;">
                {{ "{:,.0f}".format(datos.tiempo_total) }} min √ó ${{ "{:,.2f}".format(datos.tarifa_minuto) }}/min = <strong>${{ "{:,.0f}".format(datos.costo_real) }}</strong>
            </code>
        </p>
        <p style="color: #666; margin: 5px 0; font-size: 14px;">
            Este es el valor que deber√≠a recibir por el trabajo seg√∫n su tarifa
        </p>
    </div>
</div>

<!-- RESULTADO PRINCIPAL -->
<div style="border: 3px solid #ff9800; border-radius: 10px; padding: 30px; margin-bottom: 30px; text-align: center; background: linear-gradient(135deg, #fffde7 0%, #fff8e1 100%);">
    <h2 style="color: #ff6f00; margin-top: 0; margin-bottom: 20px;">üìä Porcentaje de Justicia de Pago</h2>
    
    <div style="font-size: 48px; font-weight: bold; color: #ff6f00; margin-bottom: 15px;">
        {{ "%.2f" | format(datos.porcentaje_justicia) }}%
    </div>
    
    <div style="background-color: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
        <p style="margin: 0; font-size: 16px; color: #333;">
            F√≥rmula: <code style="background-color: #f5f5f5; padding: 8px 12px; border-radius: 3px;">
                (${{ "{:,.0f}".format(datos.pago_lote) }} √∑ ${{ "{:,.0f}".format(datos.costo_real) }}) √ó 100
            </code>
        </p>
    </div>

    <!-- INTERPRETACI√ìN -->
    {% if datos.porcentaje_justicia >= 95 and datos.porcentaje_justicia <= 105 %}
        <div style="background-color: #c8e6c9; border-left: 5px solid #4CAF50; padding: 15px; border-radius: 5px;">
            <h3 style="color: #2e7d32; margin-top: 0;">‚úÖ El lote est√° JUSTAMENTE PAGADO</h3>
            <p style="color: #1b5e20; margin: 0;">
                El pago recibido est√° muy cerca del valor real del trabajo. Excelente negociaci√≥n.
            </p>
        </div>
    {% elif datos.porcentaje_justicia < 95 %}
        <div style="background-color: #ffebee; border-left: 5px solid #f44336; padding: 15px; border-radius: 5px;">
            <h3 style="color: #c62828; margin-top: 0;">‚ö†Ô∏è El lote est√° SUBPAGADO</h3>
            <p style="color: #b71c1c; margin: 0;">
                Est√°s recibiendo solo el {{ "%.2f" | format(datos.porcentaje_justicia) }}% del valor real. 
                Te faltan <strong>${{ "{:,.0f}".format(datos.costo_real - datos.pago_lote) }}</strong> para completar el valor justo.
            </p>
        </div>
    {% else %}
        <div style="background-color: #e8f5e9; border-left: 5px solid #66bb6a; padding: 15px; border-radius: 5px;">
            <h3 style="color: #2e7d32; margin-top: 0;">üí∞ El lote est√° SOBREPAGADO</h3>
            <p style="color: #1b5e20; margin: 0;">
                Est√°s recibiendo el {{ "%.2f" | format(datos.porcentaje_justicia) }}% del valor real.
                Ganancia extra: <strong>${{ "{:,.0f}".format(datos.pago_lote - datos.costo_real) }}</strong>
            </p>
        </div>
    {% endif %}
</div>

<!-- COMPARATIVA DE VALORES -->
<div style="background-color: #f3e5f5; border: 2px solid #9c27b0; border-radius: 10px; padding: 25px; margin-bottom: 30px;">
    <h2 style="color: #6a1b9a; margin-top: 0;">Comparativa de Valores</h2>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
        <div style="background-color: white; padding: 20px; border-radius: 5px; border-top: 4px solid #ff5722;">
            <h3 style="color: #ff5722; margin-top: 0;">üí∞ Pago Recibido</h3>
            <p style="font-size: 32px; margin: 10px 0; color: #ff5722; font-weight: bold;">
                ${{ "{:,.0f}".format(datos.pago_lote) }}
            </p>
            <p style="color: #666; margin: 0; font-size: 14px;">Lo que te pagaron por este lote</p>
        </div>
        
        <div style="background-color: white; padding: 20px; border-radius: 5px; border-top: 4px solid #4CAF50;">
            <h3 style="color: #4CAF50; margin-top: 0;">üíµ Costo Real del Trabajo</h3>
            <p style="font-size: 32px; margin: 10px 0; color: #4CAF50; font-weight: bold;">
                ${{ "{:,.0f}".format(datos.costo_real) }}
            </p>
            <p style="color: #666; margin: 0; font-size: 14px;">Valor seg√∫n tu tarifa de trabajo</p>
        </div>
    </div>

    <div style="background-color: white; padding: 20px; border-radius: 5px; margin-top: 20px; border: 2px solid #e0e0e0;">
        <h3 style="color: #333; margin-top: 0;">Diferencia:</h3>
        {% if datos.pago_lote >= datos.costo_real %}
            <p style="margin: 0; font-size: 18px; color: #4CAF50; font-weight: bold;">
                +${{ "{:,.0f}".format(datos.pago_lote - datos.costo_real) }} (Ganancia)
            </p>
        {% else %}
            <p style="margin: 0; font-size: 18px; color: #f44336; font-weight: bold;">
                -${{ "{:,.0f}".format(datos.costo_real - datos.pago_lote) }} (P√©rdida)
            </p>
        {% endif %}
    </div>
</div>

<!-- INFORMACI√ìN ADICIONAL -->
<div style="background-color: #e0f2f1; border: 2px solid #00897b; border-radius: 10px; padding: 25px; margin-bottom: 30px;">
    <h2 style="color: #00695c; margin-top: 0;">üìã Resumen del Lote</h2>
    
    <table style="width: 100%; border-collapse: collapse;">
        <tr style="background-color: white;">
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #666;">Tiempo unitario:</td>
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #333; font-weight: bold;">{{ datos.tiempo_unitario }} minutos</td>
        </tr>
        <tr style="background-color: #f5f5f5;">
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #666;">Cantidad:</td>
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #333; font-weight: bold;">{{ "{:,.0f}".format(datos.cantidad) }} unidades</td>
        </tr>
        <tr style="background-color: white;">
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #666;">Tiempo total:</td>
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #333; font-weight: bold;">{{ "{:,.0f}".format(datos.tiempo_total) }} minutos ({{ "%.1f" | format(datos.tiempo_total / 60) }} horas)</td>
        </tr>
        <tr style="background-color: #f5f5f5;">
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #666;">Tarifa por minuto:</td>
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #333; font-weight: bold;">${{ "{:,.2f}".format(datos.tarifa_minuto) }}/min</td>
        </tr>
        <tr style="background-color: white;">
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #666;">Costo real:</td>
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #333; font-weight: bold;">${{ "{:,.0f}".format(datos.costo_real) }}</td>
        </tr>
        <tr style="background-color: #f5f5f5;">
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #666;">Pago recibido:</td>
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #333; font-weight: bold;">${{ "{:,.0f}".format(datos.pago_lote) }}</td>
        </tr>
        <tr style="background-color: #fff9c4;">
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #666; font-weight: bold;">Justicia de pago:</td>
            <td style="padding: 12px; border-bottom: 1px solid #ddd; color: #ff6f00; font-weight: bold;">{{ "%.2f" | format(datos.porcentaje_justicia) }}%</td>
        </tr>
    </table>
</div>

<!-- BOTONES DE ACCI√ìN -->
<div style="text-align: center; margin-bottom: 30px;">
    <a href="/justicia-pago" style="display: inline-block; margin-right: 10px; padding: 12px 25px; background-color: #ff9800; color: white; text-decoration: none; border-radius: 5px; font-weight: bold; transition: background-color 0.3s;">
        üîÑ Hacer otro c√°lculo
    </a>
    <a href="/" style="display: inline-block; padding: 12px 25px; background-color: #666; color: white; text-decoration: none; border-radius: 5px; font-weight: bold; transition: background-color 0.3s;">
        üè† Volver al men√∫
    </a>
</div>

{% endblock %}
